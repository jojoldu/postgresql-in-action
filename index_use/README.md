# PostgreSQL에서 인덱스 사용법

## 인덱스 설정시 테이블 Lock 해제

PostgreSQL에서는 인덱스를 생성하는 동안에는 해당 테이블에 **읽기전용** Lock (잠금)이 적용됩니다.  
그래서 실제 서비스 운영 중에 인덱스를 적용하게 되면, **조회 기능외에는 작동하지 않아** 서비스 장애가 발생할 수 있습니다.  
  
그래서 읽기 Lock을 회피하기 위해 `CONCURRENTLY` 옵션을 추가해서 실행하면 읽기 Lock 없이 인덱스를 추가/삭제 할 수 있습니다.  
(단, **DDL은 여전히 막혀있습니다**.)

```sql
CREATE INDEX CONCURRENTLY idx_pay_1 ON pay (pay_method);
```

다만, 이렇게 할 경우 기존 인덱스 추가 방식 보다는 훨씬 더 오랜 시간동안 인덱스 추가 작업이 진행되는 점을 유의해야 합니다.